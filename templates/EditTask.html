{% extends "layout.html" %}

{% block content %}
    <h2>{{ task.get_task_name() }}</h2>
    <form method="POST" action="{{ url_for('edit_task', id=task.id) }}">
        <label>Name: </label>
        <input type="text" name="meeting_name" value="{{ task.get_task_name() }}">
        <br>
        <label>Link: </label>
        <input type="text" name="meeting_link" value="{{ task.get_link() }}">
        <br>
        <h4>Add Run Time</h4>
        <label>Every </label>
        <select name="trigger_day" required>
            <option value="Monday">Monday</option>
            <option value="Tuesday">Tuesday</option>
            <option value="Wednesday">Wednesday</option>
            <option value="Thursday">Thursday</option>
            <option value="Friday">Friday</option>
            <option value="Saturday">Saturday</option>
            <option value="Sunday">Sunday</option>
        </select>
        <label> at </label>
        <input type="time" name="time">
        <input type="submit" name="action" value="Add Run Time">
        <h4>Current Times</h4>
        {% for trigger in task.triggers %}
            <label>Every </label>
            <select id="trigger_day{{ loop.index }}" name="trigger_day{{ loop.index }}">
                <option value="Monday">Monday</option>
                <option value="Tuesday">Tuesday</option>
                <option value="Wednesday">Wednesday</option>
                <option value="Thursday">Thursday</option>
                <option value="Friday">Friday</option>
                <option value="Saturday">Saturday</option>
                <option value="Sunday">Sunday</option>
            </select>
            <label> at </label>
            <input type="time" name="time{{ loop.index }}" value="{{ trigger.formatted_time() }}">
            <br>
        {% endfor %}
        <br>
        <input type="submit" name="action" value="Save Changes">
    </form>
{% endblock content %}

{% block script %}
<script>
    {% for trigger in task.triggers %}
        selectElement(`trigger_day{{ loop.index }}`, `{{ trigger.day }}`)
    {% endfor %}

    function selectElement(id, valueToSelect) {
        let element = document.getElementById(id);
        element.value = valueToSelect;
    }
</script>
{% endblock script %}