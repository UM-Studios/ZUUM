{% extends "layout.html" %}

{% block content %}
<table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th scope="col">Enabled</th>
        <th scope="col">Name</th>
        <th scope="col">Link</th>
        <th scope="col">Run Times</th>
        <th scope="col">Next Run Time</th>
        <th scope="col">Options</th>
      </tr>
    </thead>
    <tbody>
        {% for meeting in meetings %}
            <tr>
                <td>
                  <div>
                    {% if meeting.enabled %}
                    <input type="checkbox" class="checkbox" name="enabled" id="chk" onclick="change_state('{{ meeting.id }}')">
                    {% else %}
                    <input type="checkbox" class="checkbox" name="enabled" id="chk" onclick="change_state('{{ meeting.id }}')" checked>
                    {% endif %}
                    <label class="label" for="chk">
                        <div class="ball"></div>
                    </label>
                  </div>
                </td>
                <td>{{ meeting.get_task_name() }}</td>
                <td class="text"><span>{{ meeting.get_link() }}</span></td>
                <td>
                  {% for trigger in meeting.triggers %}
                      Every {{ trigger }}
                      <br>
                  {% endfor %}
                </td>
                <td>{{ meeting.get_next_trigger() }}</td>
                <td class="centered">
                  <a class="btn btn-primary btn-sm option-button" href="{{ url_for('run_task', id=meeting.id) }}">Run Now</a>
                  <br>
                  <a class="btn btn-primary btn-sm option-button" href="{{ url_for('edit_task', id=meeting.id) }}">Edit</a>
                  <br>
                  <a class="btn btn-danger btn-sm option-button" href="{{ url_for('delete_task', id=meeting.id) }}">Delete</a>
                </td>
            </tr>
        {% endfor %}
    </tbody>
  </table>
{% endblock content %}

{% block script %}
<script>
  var script = document.createElement('script');
  script.src = 'https://code.jquery.com/jquery-3.4.1.min.js';
  script.type = 'text/javascript';
  document.getElementsByTagName('head')[0].appendChild(script);

  function change_state(id){
    console.log("hi");
    $.post(`/${id}/change_status`);
    return false;
  }
</script>
{% endblock script %}